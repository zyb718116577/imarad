layui.define(function(e){"use strict";var t=window,n={path:"",skin:"default",format:"YYYY-MM-DD",min:"1900-01-01 00:00:00",max:"2099-12-31 23:59:59",isv:!1,init:!0},r={},i=document,s="createElement",o="getElementById",u="getElementsByTagName",a=["laydate_box","laydate_void","laydate_click","LayDateSkin","skins/","/laydate.css"];t.laydate=function(e){return e=e||{},r.run(e),laydate},laydate.v="1.1",r.trim=function(e){return e=e||"",e.replace(/^\s|\s$/g,"").replace(/\s+/g," ")},r.digit=function(e){return e<10?"0"+(0|e):e},r.stopmp=function(e){return e=e||t.event,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this},r.each=function(e,t){for(var n=0,r=e.length;n<r&&t(n,e[n])!==!1;n++);},r.hasClass=function(e,t){return e=e||{},(new RegExp("\\b"+t+"\\b")).test(e.className)},r.addClass=function(e,t){return e=e||{},r.hasClass(e,t)||(e.className+=" "+t),e.className=r.trim(e.className),this},r.removeClass=function(e,t){if(e=e||{},r.hasClass(e,t)){var n=new RegExp("\\b"+t+"\\b");e.className=e.className.replace(n,"")}return this},r.removeCssAttr=function(e,t){var n=e.style;n.removeProperty?n.removeProperty(t):n.removeAttribute(t)},r.shde=function(e,t){e.style.display=t?"none":"block"},r.query=function(e){if(e&&1===e.nodeType){if("input"!==e.tagName.toLowerCase())throw new Error("选择器elem错误");return e}var t,e=r.trim(e).split(" "),n=i[o](e[0].substr(1));if(n){if(e[1]){if(/^\./.test(e[1])){var s,a=e[1].substr(1),f=new RegExp("\\b"+a+"\\b");return t=[],s=i.getElementsByClassName?n.getElementsByClassName(a):n[u]("*"),r.each(s,function(e,n){f.test(n.className)&&t.push(n)}),t[0]?t:""}return t=n[u](e[1]),t[0]?n[u](e[1]):""}return n}},r.on=function(e,n,i){return e.attachEvent?e.attachEvent("on"+n,function(){i.call(e,t.even)}):e.addEventListener(n,i,!1),r},r.stopMosup=function(e,t){"mouseup"!==e&&r.on(t,"mouseup",function(e){r.stopmp(e)})},r.run=function(e){var t=(r.query,e.elem);t&&(a.elemv=/textarea|input/.test(t.tagName.toLocaleLowerCase())?"value":"innerHTML",("init"in e?e.init:n.init)&&!t[a.elemv]&&(t[a.elemv]=laydate.now(null,e.format||n.format)),r.view(t,e),r.reshow())},r.scroll=function(e){return e=e?"scrollLeft":"scrollTop",i.body[e]|i.documentElement[e]},r.winarea=function(e){return document.documentElement[e?"clientWidth":"clientHeight"]},r.isleap=function(e){return e%4===0&&e%100!==0||e%400===0},r.checkVoid=function(e,t,n){var i=[];return e=0|e,t=0|t,n=0|n,e<r.mins[0]?i=["y"]:e>r.maxs[0]?i=["y",1]:e>=r.mins[0]&&e<=r.maxs[0]&&(e==r.mins[0]&&(t<r.mins[1]?i=["m"]:t==r.mins[1]&&n<r.mins[2]&&(i=["d"])),e==r.maxs[0]&&(t>r.maxs[1]?i=["m",1]:t==r.maxs[1]&&n>r.maxs[2]&&(i=["d",1]))),i},r.timeVoid=function(e,t){if(r.ymd[1]+1==r.mins[1]&&r.ymd[2]==r.mins[2]){if(0===t&&e<r.mins[3])return 1;if(1===t&&e<r.mins[4])return 1;if(2===t&&e<r.mins[5])return 1}else if(r.ymd[1]+1==r.maxs[1]&&r.ymd[2]==r.maxs[2]){if(0===t&&e>r.maxs[3])return 1;if(1===t&&e>r.maxs[4])return 1;if(2===t&&e>r.maxs[5])return 1}if(e>(t?59:23))return 1},r.check=function(){var e=r.options.format.replace(/YYYY|MM|DD|hh|mm|ss/g,"\\d+\\").replace(/\\$/g,""),t=new RegExp(e),n=r.elem[a.elemv],i=n.match(/\d+/g)||[],s=r.checkVoid(i[0],i[1],i[2]);if(""!==n.replace(/\s/g,"")){if(!t.test(n))return r.elem[a.elemv]="",r.msg("日期不符合格式，请重新选择。"),1;if(s[0])return r.elem[a.elemv]="",r.msg("日期不在有效期内，请重新选择。"),1;s.value=r.elem[a.elemv].match(t).join(),i=s.value.match(/\d+/g),i[1]<1?(i[1]=1,s.auto=1):i[1]>12?(i[1]=12,s.auto=1):i[1].length<2&&(s.auto=1),i[2]<1?(i[2]=1,s.auto=1):i[2]>r.months[(0|i[1])-1]?(i[2]=31,s.auto=1):i[2].length<2&&(s.auto=1),i.length>3&&(r.timeVoid(i[3],0)&&(s.auto=1),r.timeVoid(i[4],1)&&(s.auto=1),r.timeVoid(i[5],2)&&(s.auto=1)),s.auto?r.creation([i[0],0|i[1],0|i[2]],1):s.value!==r.elem[a.elemv]&&(r.elem[a.elemv]=s.value)}},r.months=[31,null,31,30,31,30,31,31,30,31,30,31],r.viewDate=function(e,t,n){var i=(r.query,{}),s=new Date;e<(0|r.mins[0])&&(e=0|r.mins[0]),e>(0|r.maxs[0])&&(e=0|r.maxs[0]),s.setFullYear(e,t,n),i.ymd=[s.getFullYear(),s.getMonth(),s.getDate()],r.months[1]=r.isleap(i.ymd[0])?29:28,s.setFullYear(i.ymd[0],i.ymd[1],1),i.FDay=s.getDay(),i.PDay=r.months[0===t?11:t-1]-i.FDay+1,i.NDay=1,r.each(a.tds,function(e,t){var n,s=i.ymd[0],o=i.ymd[1]+1;t.className="",e<i.FDay?(t.innerHTML=n=e+i.PDay,r.addClass(t,"laydate_nothis"),1===o&&(s-=1),o=1===o?12:o-1):e>=i.FDay&&e<i.FDay+r.months[i.ymd[1]]?(t.innerHTML=n=e-i.FDay+1,e-i.FDay+1===i.ymd[2]&&(r.addClass(t,a[2]),i.thisDay=t)):(t.innerHTML=n=i.NDay++,r.addClass(t,"laydate_nothis"),12===o&&(s+=1),o=12===o?1:o+1),r.checkVoid(s,o,n)[0]&&r.addClass(t,a[1]),r.options.festival&&r.festival(t,o+"."+n),t.setAttribute("y",s),t.setAttribute("m",o),t.setAttribute("d",n),s=o=n=null}),r.valid=!r.hasClass(i.thisDay,a[1]),r.ymd=i.ymd,a.year.value=r.ymd[0]+"年",a.month.value=r.digit(r.ymd[1]+1)+"月",r.each(a.mms,function(e,t){var n=r.checkVoid(r.ymd[0],(0|t.getAttribute("m"))+1);"y"===n[0]||"m"===n[0]?r.addClass(t,a[1]):r.removeClass(t,a[1]),r.removeClass(t,a[2]),n=null}),r.addClass(a.mms[r.ymd[1]],a[2]),i.times=[0|r.inymd[3]||0,0|r.inymd[4]||0,0|r.inymd[5]||0],r.each(new Array(3),function(e){r.hmsin[e].value=r.digit(r.timeVoid(i.times[e],e)?0|r.mins[e+3]:0|i.times[e])}),r[r.valid?"removeClass":"addClass"](a.ok,a[1])},r.festival=function(e,t){var n;switch(t){case"1.1":n="元旦";break;case"3.8":n="妇女";break;case"4.5":n="清明";break;case"5.1":n="劳动";break;case"6.1":n="儿童";break;case"9.10":n="教师";break;case"10.1":n="国庆"}n&&(e.innerHTML=n),n=null},r.viewYears=function(e){var t=r.query,n="";r.each(new Array(14),function(t){n+=7===t?"<li "+(parseInt(a.year.value)===e?'class="'+a[2]+'"':"")+' y="'+e+'">'+e+"年</li>":'<li y="'+(e-7+t)+'">'+(e-7+t)+"年</li>"}),t("#laydate_ys").innerHTML=n,r.each(t("#laydate_ys li"),function(e,t){"y"===r.checkVoid(t.getAttribute("y"))[0]?r.addClass(t,a[1]):r.on(t,"click",function(e){r.stopmp(e).reshow(),r.viewDate(0|this.getAttribute("y"),r.ymd[1],r.ymd[2])})})},r.initDate=function(){var e=(r.query,new Date),t=r.elem[a.elemv].match(/\d+/g)||[];t.length<3&&(t=r.options.start.match(/\d+/g)||[],t.length<3&&(t=[e.getFullYear(),e.getMonth()+1,e.getDate()])),r.inymd=t,r.viewDate(t[0],t[1]-1,t[2])},r.iswrite=function(){var e=r.query,t={time:e("#laydate_hms")};r.shde(t.time,!r.options.istime),r.shde(a.oclear,"isclear"in r.options?!r.options.isclear:!1),r.shde(a.otoday,"istoday"in r.options?!r.options.istoday:!1),r.shde(a.ok,"issure"in r.options?!r.options.issure:!1)},r.orien=function(e,t){var n,i=r.elem.getBoundingClientRect();e.style.left=i.left+(t?0:r.scroll(1))+"px",n=i.bottom+e.offsetHeight/1.5<=r.winarea()?i.bottom-1:i.top>e.offsetHeight/1.5?i.top-e.offsetHeight+1:r.winarea()-e.offsetHeight,e.style.top=Math.max(n+(t?0:r.scroll()),1)+"px"},r.follow=function(e){r.options.fixed?(e.style.position="fixed",r.orien(e,1)):(e.style.position="absolute",r.orien(e))},r.viewtb=function(){var e,t=[],n=["日","一","二","三","四","五","六"],o={},a=i[s]("table"),f=i[s]("thead");return f.appendChild(i[s]("tr")),o.creath=function(e){var t=i[s]("th");t.innerHTML=n[e],f[u]("tr")[0].appendChild(t),t=null},r.each(new Array(6),function(n){t.push([]),e=a.insertRow(0),r.each(new Array(7),function(r){t[n][r]=0,0===n&&o.creath(r),e.insertCell(r)})}),a.insertBefore(f,a.children[0]),a.id=a.className="laydate_table",e=t=null,a.outerHTML.toLowerCase()}(),r.view=function(e,t){var o,u=r.query,f={};t=t||e,r.elem=e,r.options=t,r.options.format||(r.options.format=n.format),r.options.start=r.options.start||"",r.mm=f.mm=[r.options.min||n.min,r.options.max||n.max],r.mins=f.mm[0].match(/\d+/g),r.maxs=f.mm[1].match(/\d+/g),r.box?r.shde(r.box):(o=i[s]("div"),o.id=a[0],o.className=a[0],o.style.cssText="position: absolute;",o.setAttribute("name","laydate-v"+laydate.v),o.innerHTML=f.html='<div class="laydate_top"><div class="laydate_ym laydate_y" id="laydate_YY"><a class="laydate_choose laydate_chprev laydate_tab"><cite></cite></a><input id="laydate_y" readonly><label></label><a class="laydate_choose laydate_chnext laydate_tab"><cite></cite></a><div class="laydate_yms"><a class="laydate_tab laydate_chtop"><cite></cite></a><ul id="laydate_ys"></ul><a class="laydate_tab laydate_chdown"><cite></cite></a></div></div><div class="laydate_ym laydate_m" id="laydate_MM"><a class="laydate_choose laydate_chprev laydate_tab"><cite></cite></a><input id="laydate_m" readonly><label></label><a class="laydate_choose laydate_chnext laydate_tab"><cite></cite></a><div class="laydate_yms" id="laydate_ms">'+function(){var e="";return r.each(new Array(12),function(t){e+='<span m="'+t+'">'+r.digit(t+1)+"月</span>"}),e}()+"</div></div></div>"+r.viewtb+'<div class="laydate_bottom"><ul id="laydate_hms"><li class="laydate_sj">时间</li><li><input readonly>:</li><li><input readonly>:</li><li><input readonly></li></ul><div class="laydate_time" id="laydate_time"></div><div class="laydate_btn"><a id="laydate_clear">清空</a><a id="laydate_today">今天</a><a id="laydate_ok">确认</a></div>'+(n.isv?'<a href="http://sentsin.com/layui/laydate/" class="laydate_v" target="_blank">laydate-v'+laydate.v+"</a>":"")+"</div>",i.body.appendChild(o),r.box=u("#"+a[0]),r.events(),o=null),r.follow(r.box),t.zIndex?r.box.style.zIndex=t.zIndex:r.removeCssAttr(r.box,"z-index"),r.stopMosup("click",r.box),r.initDate(),r.iswrite(),r.check()},r.reshow=function(){return r.each(r.query("#"+a[0]+" .laydate_show"),function(e,t){r.removeClass(t,"laydate_show")}),this},r.close=function(){r.reshow(),r.shde(r.query("#"+a[0]),1),r.elem=null},r.parse=function(e,t,i){return e=e.concat(t),i=i||(r.options?r.options.format:n.format),i.replace(/YYYY|MM|DD|hh|mm|ss/g,function(t,n){return e.index=0|++e.index,r.digit(e[e.index])})},r.creation=function(e,t){var n=(r.query,r.hmsin),i=r.parse(e,[n[0].value,n[1].value,n[2].value]);r.elem[a.elemv]=i,t||(r.close(),"function"==typeof r.options.choose&&r.options.choose(i))},r.events=function(){var e=r.query,n={box:"#"+a[0]};r.addClass(i.body,"laydate_body"),a.tds=e("#laydate_table td"),a.mms=e("#laydate_ms span"),a.year=e("#laydate_y"),a.month=e("#laydate_m"),r.each(e(n.box+" .laydate_ym"),function(e,t){r.on(t,"click",function(t){r.stopmp(t).reshow(),r.addClass(this[u]("div")[0],"laydate_show"),e||(n.YY=parseInt(a.year.value),r.viewYears(n.YY))})}),r.on(e(n.box),"click",function(){r.reshow()}),n.tabYear=function(e){0===e?r.ymd[0]--:1===e?r.ymd[0]++:2===e?n.YY-=14:n.YY+=14,e<2?(r.viewDate(r.ymd[0],r.ymd[1],r.ymd[2]),r.reshow()):r.viewYears(n.YY)},r.each(e("#laydate_YY .laydate_tab"),function(e,t){r.on(t,"click",function(t){r.stopmp(t),n.tabYear(e)})}),n.tabMonth=function(e){e?(r.ymd[1]++,12===r.ymd[1]&&(r.ymd[0]++,r.ymd[1]=0)):(r.ymd[1]--,r.ymd[1]===-1&&(r.ymd[0]--,r.ymd[1]=11)),r.viewDate(r.ymd[0],r.ymd[1],r.ymd[2])},r.each(e("#laydate_MM .laydate_tab"),function(e,t){r.on(t,"click",function(t){r.stopmp(t).reshow(),n.tabMonth(e)})}),r.each(e("#laydate_ms span"),function(e,t){r.on(t,"click",function(e){r.stopmp(e).reshow(),r.hasClass(this,a[1])||r.viewDate(r.ymd[0],0|this.getAttribute("m"),r.ymd[2])})}),r.each(e("#laydate_table td"),function(e,t){r.on(t,"click",function(e){r.hasClass(this,a[1])||(r.stopmp(e),r.creation([0|this.getAttribute("y"),0|this.getAttribute("m"),0|this.getAttribute("d")]))})}),a.oclear=e("#laydate_clear"),r.on(a.oclear,"click",function(){r.elem[a.elemv]="",r.close()}),a.otoday=e("#laydate_today"),r.on(a.otoday,"click",function(){var e=new Date;r.creation([e.getFullYear(),e.getMonth()+1,e.getDate()])}),a.ok=e("#laydate_ok"),r.on(a.ok,"click",function(){r.valid&&r.creation([r.ymd[0],r.ymd[1]+1,r.ymd[2]])}),n.times=e("#laydate_time"),r.hmsin=n.hmsin=e("#laydate_hms input"),n.hmss=["小时","分钟","秒数"],n.hmsarr=[],r.msg=function(t,i){var s='<div class="laydte_hsmtex">'+(i||"提示")+"<span>×</span></div>";"string"==typeof t?(s+="<p>"+t+"</p>",r.shde(e("#"+a[0])),r.removeClass(n.times,"laydate_time1").addClass(n.times,"laydate_msg")):(n.hmsarr[t]?s=n.hmsarr[t]:(s+='<div id="laydate_hmsno" class="laydate_hmsno">',r.each(new Array(0===t?24:60),function(e){s+="<span>"+e+"</span>"}),s+="</div>",n.hmsarr[t]=s),r.removeClass(n.times,"laydate_msg"),r[0===t?"removeClass":"addClass"](n.times,"laydate_time1")),r.addClass(n.times,"laydate_show"),n.times.innerHTML=s},n.hmson=function(t,n){var i=e("#laydate_hmsno span"),s=r.valid?null:1;r.each(i,function(e,i){s?r.addClass(i,a[1]):r.timeVoid(e,n)?r.addClass(i,a[1]):r.on(i,"click",function(e){r.hasClass(this,a[1])||(t.value=r.digit(0|this.innerHTML))})}),r.addClass(i[0|t.value],"laydate_click")},r.each(n.hmsin,function(e,t){r.on(t,"click",function(t){r.stopmp(t).reshow(),r.msg(e,n.hmss[e]),n.hmson(this,e)})}),r.on(i,"mouseup",function(){var t=e("#"+a[0]);t&&"none"!==t.style.display&&(r.check()||r.close())}).on(i,"keydown",function(e){e=e||t.event;var n=e.keyCode;13===n&&r.elem&&r.creation([r.ymd[0],r.ymd[1]+1,r.ymd[2]])})},laydate.reset=function(){r.box&&r.elem&&r.follow(r.box)},laydate.now=function(e,t){var n=new Date(0|e?function(e){return e<864e5?+(new Date)+864e5*e:e}(parseInt(e)):+(new Date));return r.parse([n.getFullYear(),n.getMonth()+1,n.getDate()],[n.getHours(),n.getMinutes(),n.getSeconds()],t)},layui.addcss("modules/laydate/laydate.css",function(){},"laydatecss"),e("laydate",laydate)});